<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Cart - U-Craft</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Playfair:ital,opsz,wght@0,5..1200,300..900;1,5..1200,300..900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }
        body {
            background-image: url('/images/background/gray-wood-texture.jpg');
            background-size: contain;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        .mainhead {
            display: flex;
            justify-content: space-between;
            margin: 10px;
            align-items: center;
        }
        .subhead {
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .subhead a {
            text-decoration: none;
            color: black;
        }
        .subhead li {
            margin: 20px 10px;
        }
        nav ul {
            display: flex;
            list-style: none;
        }
        .buttons {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        .buttons .searchBar {
            width: 15rem;
            background-color: transparent;
            border: 1px solid;
        }
        .buttons img {
            height: 25px;
            cursor: pointer;
        }
        .buttons img:hover {
            filter: contrast(0);
        }
        .buttons button {
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            border: 1px solid #ccc;
        }
        .buttons button:hover {
            background-color: rgb(64, 63, 63);
            color: aliceblue;
        }
        
        /* Main content container */
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 30px auto;
            padding: 0;
            display: flex;
            flex-direction: column;
            flex-grow: 1;
        }
        
        /* Cart styling */
        .cart-section {
            background-color: #fff;
            border: 1px solid #ccc;
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .cart-section h1 {
            font-family: 'Playfair', serif;
            font-size: 28px;
            margin-bottom: 20px;
            color: #333;
        }
        
        .cart-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin-bottom: 30px;
        }
        
        .cart-table th {
            text-align: left;
            padding: 12px 15px;
            background-color: #f9f9f9;
            color: #333;
            font-weight: 600;
            border-bottom: 1px solid #eee;
        }
        
        .cart-table td {
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
            color: #333;
            vertical-align: middle;
        }
        
        .cart-table tr:last-child td {
            border-bottom: none;
        }
        
        .cart-table button {
            background-color: #000;
            color: #fff;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        
        .cart-table button:hover {
            background-color: #333;
        }
        
        .empty-cart {
            padding: 40px 0;
            text-align: center;
            color: #777;
            font-size: 18px;
        }
        
        .continue-shopping {
            display: inline-block;
            background-color: #000;
            color: #fff;
            text-decoration: none;
            padding: 10px 20px;
            border-radius: 4px;
            font-weight: 500;
            margin-top: 15px;
            transition: background-color 0.2s ease;
        }
        
        .continue-shopping:hover {
            background-color: #333;
        }
        
        .cart-summary {
            background-color: #f9f9f9;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .cart-total {
            font-size: 18px;
            font-weight: 600;
        }
        
        .checkout-btn {
            background-color: #000;
            color: #fff;
            border: none;
            padding: 10px 25px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: background-color 0.2s ease;
        }
        
        .checkout-btn:hover {
            background-color: #333;
        }
        
        .error-message {
            color: #d9534f;
            padding: 10px;
            margin-bottom: 15px;
            border-radius: 4px;
            background-color: rgba(217, 83, 79, 0.1);
            border: 1px solid rgba(217, 83, 79, 0.2);
        }
        
        /* Breadcrumb styling */
        #breadcrumbs {
            margin: 15px 0;
        }
        
        #breadcrumbs ol {
            list-style: none;
            display: flex;
            gap: 5px;
            font-size: 14px;
            color: #888;
            padding: 0;
        }
        
        #breadcrumbs a {
            color: #888;
            text-decoration: none;
            transition: color 0.2s ease;
        }
        
        #breadcrumbs a:hover {
            color: #333;
        }
        
        footer {
            background-color: black;
            color: white;
            display: flex;
            justify-content: space-around;
            padding: 40px 0;
            flex-wrap: wrap;
            width: 100%;
            margin-top: auto;
        }
        footer div {
            margin: 10px;
            min-width: 150px;
        }
        footer div p {
            font-weight: bold;
            margin-bottom: 10px;
        }
        footer ul {
            list-style: none;
        }
        footer li {
            margin: 8px 0;
        }
        footer input[type="text"] {
            padding: 10px;
            margin-top: 10px;
            border-radius: 4px;
            border: none;
            width: 200px;
        }
        
        @media (max-width: 768px) {
            .container {
                width: 95%;
                padding: 10px;
            }
            .cart-table {
                display: block;
                overflow-x: auto;
            }
            .cart-summary {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="mainhead">
            <div class="logo">
                <a href="/"><img src="/images/logo.png" alt="U-Craft Logo" style="height: 60px;"></a>
            </div>
            <nav class="subhead">
                <ul>
                    <li><a href="/">Home</a></li>
                    <li><a href="/productListing">Shop</a></li>
                    <li><a href="/customListing">Custom</a></li>
                    <li><a href="/about">About</a></li>
                    <li><a href="/contact">Contact</a></li>
                </ul>
            </nav>
            <div class="buttons">
                <input type="text" class="searchBar" placeholder="Search...">
                <a href="/wishlist"><img src="/images/icons/heart.svg" alt="Wishlist"></a>
                <a href="/cart"><img src="/images/icons/shopping-bag.svg" alt="Cart"></a>
                <a href="/profile"><img src="/images/icons/user.svg" alt="Profile"></a>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- Breadcrumbs -->
        <nav id="breadcrumbs"></nav>
        
        <div class="cart-section">
            <h1>Your Cart</h1>
            
            <!-- Error message display -->
            <% if (error) { %>
                <div class="error-message"><%= error %></div>
            <% } %>
            
            <!-- Cart contents -->
            <% if (!cart || cart.items.length === 0) { %>
                <div class="empty-cart">
                    <p>Your cart is empty.</p>
                    <a href="/productListing" class="continue-shopping">Continue Shopping</a>
                </div>
            <% } else { %>
                <table class="cart-table">
                    <thead>
                        <tr>
                            <th>Product</th>
                            <th>Quantity</th>
                            <th>Price</th>
                            <th>Total</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% 
                        let cartTotal = 0;
                        cart.items.forEach(item => { 
                            const itemTotal = item.quantity * item.productId.salePrice;
                            cartTotal += itemTotal;
                        %>
                            <tr>
                                <td><%= item.productId.productName %></td>
                                <td>
                                    
                                         <input type="number" name="quantity" value="<%= item.quantity %>" min="1" style="width: 60px; padding: 5px; border: 1px solid #ccc; border-radius: 4px;">
                                </td>
                                <td>Rs. <%= item.productId.salePrice.toFixed(2) %></td>
                                <td>Rs. <%= itemTotal.toFixed(2) %></td>
                                <td>
                                    <form action="/cart/remove/<%= item.productId._id %>" method="POST">
                                        <button type="submit">Remove</button>
                                    </form>
                                </td>
                            </tr>
                        <% }) %>
                    </tbody>
                </table>
                
                <!-- Cart summary -->
                <div class="cart-summary">
                    <div class="cart-total">
                        Total: Rs. <%= cartTotal.toFixed(2) %>
                    </div>
                    <div>
                        <a href="/productListing" class="continue-shopping">Continue Shopping</a>
                        <a href="/checkout" class="checkout-btn">Proceed to Checkout</a>
                    </div>
                </div>
            <% } %>
        </div>
    </div>

    <footer>
        <div>
            <p>Shop</p>
            <ul>
                <li>All Products</li>
                <li>New Arrivals</li>
                <li>Best Sellers</li>
                <li>Special Offers</li>
            </ul>
        </div>
        <div>
            <p>Information</p>
            <ul>
                <li>About Us</li>
                <li>Contact Us</li>
                <li>Return Policy</li>
                <li>Terms & Conditions</li>
            </ul>
        </div>
        <div>
            <p>Customer Service</p>
            <ul>
                <li>FAQ</li>
                <li>Shipping Info</li>
                <li>Track Order</li>
                <li>Privacy Policy</li>
            </ul>
        </div>
        <div>
            <p>Newsletter</p>
            <div>Subscribe to get updates on new products and special offers.</div>
            <input type="text" placeholder="Enter your email">
        </div>
    </footer>

    <script>
        // Dynamic Breadcrumbs
        (function() {
            const prettyNames = {
                '': 'Home',
                'home': 'Home',
                'productlisting': 'Shop',
                'customlisting': 'Custom',
                'profile': 'Profile',
                'cart': 'Cart',
                'wishlist': 'Wishlist',
                'addresses': 'Addresses',
                'orders': 'Orders',
                'checkout': 'Checkout',
                'about': 'About',
                'contact': 'Contact'
            };
            function toTitle(str) {
                return prettyNames[str.toLowerCase()] || str.charAt(0).toUpperCase() + str.slice(1);
            }
            const path = window.location.pathname.replace(/^\/+|\/+$/g, '').split('/');
            let crumbs = [];
            let url = '';
            for (let i = 0; i < path.length; i++) {
                url += '/' + path[i];
                crumbs.push({
                    name: toTitle(path[i]),
                    url: i < path.length - 1 ? url : null
                });
            }
            if (crumbs.length === 0 || crumbs[0].name !== 'Home') {
                crumbs.unshift({ name: 'Home', url: '/' });
            }
            const nav = document.getElementById('breadcrumbs');
            if (nav) {
                nav.innerHTML = '<ol style="list-style:none;display:flex;gap:5px;font-size:14px;color:#888;">' +
                    crumbs.map((crumb, idx) => {
                        if (crumb.url) {
                            return `<li><a href="${crumb.url}" style="color:#888;text-decoration:none;">${crumb.name}</a></li>` +
                                (idx < crumbs.length - 1 ? '<li style="color:#888;">/</li>' : '');
                        } else {
                            return `<li style="color:#333;">${crumb.name}</li>`;
                        }
                    }).join('') +
                    '</ol>';
            }
        })();
    </script>
</body>
</html>
